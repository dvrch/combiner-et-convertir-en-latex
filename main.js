/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var P=Object.defineProperty;var ht=Object.getOwnPropertyDescriptor;var mt=Object.getOwnPropertyNames;var xt=Object.prototype.hasOwnProperty;var $t=(t,e)=>{for(var n in e)P(t,n,{get:e[n],enumerable:!0})},gt=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of mt(e))!xt.call(t,r)&&r!==n&&P(t,r,{get:()=>e[r],enumerable:!(o=ht(e,r))||o.enumerable});return t};var yt=t=>gt(P({},"__esModule",{value:!0}),t);var re={};$t(re,{default:()=>L});module.exports=yt(re);var _t=require("obsidian");function m(){}function bt(t,e){for(let n in e)t[n]=e[n];return t}function R(t){return t()}function M(){return Object.create(null)}function d(t){t.forEach(R)}function A(t){return typeof t=="function"}function V(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function W(t){return Object.keys(t).length===0}function H(t,e,n,o){if(t){let r=J(t,e,n,o);return t[0](r)}}function J(t,e,n,o){return t[1]&&o?bt(n.ctx.slice(),t[1](o(e))):n.ctx}function X(t,e,n,o){if(t[2]&&o){let r=t[2](o(n));if(e.dirty===void 0)return r;if(typeof r=="object"){let i=[],l=Math.max(e.dirty.length,r.length);for(let s=0;s<l;s+=1)i[s]=e.dirty[s]|r[s];return i}return e.dirty|r}return e.dirty}function K(t,e,n,o,r,i){if(r){let l=J(e,n,o,i);t.p(l,r)}}function Y(t){if(t.ctx.length>32){let e=[],n=t.ctx.length/32;for(let o=0;o<n;o++)e[o]=-1;return e}return-1}var I=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var D=class t{_listeners="WeakMap"in I?new WeakMap:void 0;_observer=void 0;options;constructor(e){this.options=e}observe(e,n){return this._listeners.set(e,n),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver(e=>{for(let n of e)t.entries.set(n.target,n),this._listeners.get(n.target)?.(n)}))}};D.entries="WeakMap"in I?new WeakMap:void 0;var Q=!1;function Z(){Q=!0}function tt(){Q=!1}function et(t,e){t.appendChild(e)}function nt(t,e,n){let o=rt(t);if(!o.getElementById(e)){let r=E("style");r.id=e,r.textContent=n,Ft(o,r)}}function rt(t){if(!t)return document;let e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ft(t,e){return et(t.head||t,e),e.sheet}function k(t,e,n){t.insertBefore(e,n||null)}function x(t){t.parentNode&&t.parentNode.removeChild(t)}function E(t){return document.createElement(t)}function S(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ot(t){return Array.from(t.childNodes)}function it(t){let e={};return t.childNodes.forEach(n=>{e[n.slot||"default"]=!0}),e}var b;function _(t){b=t}var $=[];var ct=[],v=[],lt=[],Mt=Promise.resolve(),q=!1;function ut(){q||(q=!0,Mt.then(N))}function C(t){v.push(t)}var B=new Set,w=0;function N(){if(w!==0)return;let t=b;do{try{for(;w<$.length;){let e=$[w];w++,_(e),At(e.$$)}}catch(e){throw $.length=0,w=0,e}for(_(null),$.length=0,w=0;ct.length;)ct.pop()();for(let e=0;e<v.length;e+=1){let n=v[e];B.has(n)||(B.add(n),n())}v.length=0}while($.length);for(;lt.length;)lt.pop()();q=!1,B.clear(),_(t)}function At(t){if(t.fragment!==null){t.update(),d(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}function at(t){let e=[],n=[];v.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),v=e}var T=new Set,Dt;function F(t,e){t&&t.i&&(T.delete(t),t.i(e))}function j(t,e,n,o){if(t&&t.o){if(T.has(t))return;T.add(t),Dt.c.push(()=>{T.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}var Nt=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Tt=new Set([...Nt]);function Pt(t,e,n){let{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),C(()=>{let i=t.$$.on_mount.map(R).filter(A);t.$$.on_destroy?t.$$.on_destroy.push(...i):d(i),t.$$.on_mount=[]}),r.forEach(C)}function Rt(t,e){let n=t.$$;n.fragment!==null&&(at(n.after_update),d(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function It(t,e){t.$$.dirty[0]===-1&&($.push(t),ut(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ft(t,e,n,o,r,i,l=null,s=[-1]){let u=b;_(t);let c=t.$$={fragment:null,ctx:[],props:i,update:m,not_equal:r,bound:M(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:M(),dirty:s,skip_bound:!1,root:e.target||u.$$.root};l&&l(c.root);let g=!1;if(c.ctx=n?n(t,e.props||{},(a,y,...h)=>{let p=h.length?h[0]:y;return c.ctx&&r(c.ctx[a],c.ctx[a]=p)&&(!c.skip_bound&&c.bound[a]&&c.bound[a](p),g&&It(t,a)),y}):[],c.update(),g=!0,d(c.before_update),c.fragment=o?o(c.ctx):!1,e.target){if(e.hydrate){Z();let a=ot(e.target);c.fragment&&c.fragment.l(a),a.forEach(x)}else c.fragment&&c.fragment.c();e.intro&&F(t.$$.fragment),Pt(t,e.target,e.anchor),tt(),N()}_(u)}var Bt;typeof HTMLElement=="function"&&(Bt=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(t,e,n){super(),this.$$ctor=t,this.$$s=e,n&&this.attachShadow({mode:"open"})}addEventListener(t,e,n){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){let o=this.$$c.$on(t,e);this.$$l_u.set(e,o)}super.addEventListener(t,e,n)}removeEventListener(t,e,n){if(super.removeEventListener(t,e,n),this.$$c){let o=this.$$l_u.get(e);o&&(o(),this.$$l_u.delete(e))}if(this.$$l[t]){let o=this.$$l[t].indexOf(e);o>=0&&this.$$l[t].splice(o,1)}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let t=function(r){return()=>{let i;return{c:function(){i=E("slot"),r!=="default"&&S(i,"name",r)},m:function(u,c){k(u,i,c)},d:function(u){u&&x(i)}}}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;let e={},n=it(this);for(let r of this.$$s)r in n&&(e[r]=[t(r)]);for(let r of this.attributes){let i=this.$$g_p(r.name);i in this.$$d||(this.$$d[i]=z(i,r.value,this.$$p_d,"toProp"))}for(let r in this.$$p_d)!(r in this.$$d)&&this[r]!==void 0&&(this.$$d[r]=this[r],delete this[r]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});let o=()=>{this.$$r=!0;for(let r in this.$$p_d)if(this.$$d[r]=this.$$c.$$.ctx[this.$$c.$$.props[r]],this.$$p_d[r].reflect){let i=z(r,this.$$d[r],this.$$p_d,"toAttribute");i==null?this.removeAttribute(this.$$p_d[r].attribute||r):this.setAttribute(this.$$p_d[r].attribute||r,i)}this.$$r=!1};this.$$c.$$.after_update.push(o),o();for(let r in this.$$l)for(let i of this.$$l[r]){let l=this.$$c.$on(r,i);this.$$l_u.set(i,l)}this.$$l={}}}attributeChangedCallback(t,e,n){this.$$r||(t=this.$$g_p(t),this.$$d[t]=z(t,n,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(t){return Object.keys(this.$$p_d).find(e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t)||t}});function z(t,e,n,o){let r=n[t]?.type;if(e=r==="Boolean"&&typeof e!="boolean"?e!=null:e,!o||!n[t])return e;if(o==="toAttribute")switch(r){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e??null;default:return e}else switch(r){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}var O=class{$$=void 0;$$set=void 0;$destroy(){Rt(this,1),this.$destroy=m}$on(e,n){if(!A(n))return m;let o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{let r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!W(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var pt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(pt);function Kt(t){nt(t,"svelte-1rhwprr",".combiner-app.svelte-1rhwprr{width:100%}")}function Yt(t){let e,n,o=t[2].default,r=H(o,t,t[1],null);return{c(){e=E("div"),r&&r.c(),S(e,"class","combiner-app svelte-1rhwprr")},m(i,l){k(i,e,l),r&&r.m(e,null),n=!0},p(i,[l]){r&&r.p&&(!n||l&2)&&K(r,o,i,i[1],n?X(o,i[1],l,null):Y(i[1]),null)},i(i){n||(F(r,i),n=!0)},o(i){j(r,i),n=!1},d(i){i&&x(e),r&&r.d(i)}}}async function Qt(t,e){let n=new Set;async function o(r){let i=/!\[\[([^\]#|^]+)(?:(#)([^\]|]+))?(?:(\^)([^\]|]+))?(?:\|([^\]]+))?\]\]/g,l=r,s;for(;(s=i.exec(r))!==null;){let u=s[0],c=s[1].trim(),g=s[2],a=s[3],y=s[4],h=s[5];if(!n.has(c)){n.add(c);try{let p=e.metadataCache.getFirstLinkpathDest(c,"");if(p){let f=await e.vault.read(p);g&&a?f=Zt(f,a):y&&h&&(f=te(f,h));let U=await o(f);l=l.replace(u,U)}else l=l.replace(u,`<!-- Linked file not found: ${c} -->`)}catch{l=l.replace(u,`<!-- Error: Could not process ${c} -->`)}finally{n.delete(c)}}}return l}return await o(t)}function Zt(t,e){let n=t.split(`
`),o=new RegExp(`^#+\\s*${e}$`),r=!1,i=[],l=0;for(let s of n){let u=s.match(/^(#+)\s*(.*)$/);if(u){let c=u[1].length;o.test(s)?(r=!0,l=c,i.push(s)):r&&c<=l&&(r=!1)}r&&i.push(s)}return i.join(`
`)}function te(t,e){let n=t.split(`
`),o=new RegExp(`\\s\\^${e}$`);for(let r=0;r<n.length;r++)if(o.test(n[r]))return n[r].replace(o,"").trim();return""}async function ee(t,e,n){let o=1,r=`${e}-combined.md`;for(;await t.vault.adapter.exists(`${n}/${r}`);)r=`${e}-combined-${o}.md`,o++;return r}function ne(t,e,n){let{$$slots:o={},$$scope:r}=e,{plugin:i}=e;async function l(){let{app:s}=i,u=s.workspace.getActiveFile();if(!u||u.extension!=="md"||!u.parent){s.workspace.trigger("notice","Aucun fichier Markdown valide s\xE9lectionn\xE9.");return}s.workspace.trigger("notice",`Combinaison de ${u.name}...`);let c=await s.vault.read(u),g=await Qt(c,s),a=u.parent.path,y=u.basename,h=await ee(s,y,a),p=`${a}/${h}`;try{await s.vault.create(p,g),s.workspace.trigger("notice",`Fichier combin\xE9 cr\xE9\xE9 : ${p}`);let f=s.vault.getAbstractFileByPath(p);f&&await s.workspace.getLeaf("split","vertical").openFile(f)}catch(f){s.workspace.trigger("notice",`Erreur lors de la cr\xE9ation du fichier combin\xE9 : ${f?.message||f}`)}}return t.$$set=s=>{"plugin"in s&&n(0,i=s.plugin),"$$scope"in s&&n(1,r=s.$$scope)},[i,r,o]}var G=class extends O{constructor(e){super(),ft(this,e,ne,Yt,V,{plugin:0},Kt)}},dt=G;var L=class extends _t.Plugin{appView=null;async onload(){this.appView=new dt({target:document.body,props:{plugin:this}})}onunload(){this.appView?.$destroy(),this.appView=null}};

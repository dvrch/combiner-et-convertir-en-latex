/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var z=Object.defineProperty;var yt=Object.getOwnPropertyDescriptor;var gt=Object.getOwnPropertyNames;var bt=Object.prototype.hasOwnProperty;var wt=(e,t)=>{for(var r in t)z(e,r,{get:t[r],enumerable:!0})},vt=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of gt(t))!bt.call(e,n)&&n!==r&&z(e,n,{get:()=>t[n],enumerable:!(o=yt(t,n))||o.enumerable});return e};var Ft=e=>vt(z({},"__esModule",{value:!0}),e);var le={};wt(le,{default:()=>q});module.exports=Ft(le);var $=require("obsidian");function p(){}function G(e){return e()}function L(){return Object.create(null)}function _(e){e.forEach(G)}function P(e){return typeof e=="function"}function Q(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Z(e){return Object.keys(e).length===0}var U=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var R=class e{_listeners="WeakMap"in U?new WeakMap:void 0;_observer=void 0;options;constructor(t){this.options=t}observe(t,r){return this._listeners.set(t,r),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver(t=>{for(let r of t)e.entries.set(r.target,r),this._listeners.get(r.target)?.(r)}))}};R.entries="WeakMap"in U?new WeakMap:void 0;var tt=!1;function et(){tt=!0}function nt(){tt=!1}function M(e,t){e.appendChild(t)}function rt(e,t,r){let o=ot(e);if(!o.getElementById(t)){let n=x("style");n.id=t,n.textContent=r,St(o,n)}}function ot(e){if(!e)return document;let t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function St(e,t){return M(e.head||e,t),t.sheet}function m(e,t,r){e.insertBefore(t,r||null)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function x(e){return document.createElement(e)}function W(e){return document.createTextNode(e)}function F(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function it(e){return Array.from(e.childNodes)}function st(e,t){t=""+t,e.data!==t&&(e.data=t)}function ct(e){let t={};return e.childNodes.forEach(r=>{t[r.slot||"default"]=!0}),t}var k;function h(e){k=e}var v=[];var ut=[],S=[],at=[],Nt=Promise.resolve(),V=!1;function ft(){V||(V=!0,Nt.then(I))}function A(e){S.push(e)}var H=new Set,E=0;function I(){if(E!==0)return;let e=k;do{try{for(;E<v.length;){let t=v[E];E++,h(t),Tt(t.$$)}}catch(t){throw v.length=0,E=0,t}for(h(null),v.length=0,E=0;ut.length;)ut.pop()();for(let t=0;t<S.length;t+=1){let r=S[t];H.has(r)||(H.add(r),r())}S.length=0}while(v.length);for(;at.length;)at.pop()();V=!1,H.clear(),h(e)}function Tt(e){if(e.fragment!==null){e.update(),_(e.before_update);let t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(A)}}function pt(e){let t=[],r=[];S.forEach(o=>e.indexOf(o)===-1?t.push(o):r.push(o)),r.forEach(o=>o()),S=t}var jt=new Set;function B(e,t){e&&e.i&&(jt.delete(e),e.i(t))}var Pt=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Rt=new Set([...Pt]);function qt(e,t,r){let{fragment:o,after_update:n}=e.$$;o&&o.m(t,r),A(()=>{let i=e.$$.on_mount.map(G).filter(P);e.$$.on_destroy?e.$$.on_destroy.push(...i):_(i),e.$$.on_mount=[]}),n.forEach(A)}function zt(e,t){let r=e.$$;r.fragment!==null&&(pt(r.after_update),_(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function Gt(e,t){e.$$.dirty[0]===-1&&(v.push(e),ft(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function dt(e,t,r,o,n,i,c=null,a=[-1]){let f=k;h(e);let s=e.$$={fragment:null,ctx:[],props:i,update:p,not_equal:n,bound:L(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(f?f.$$.context:[])),callbacks:L(),dirty:a,skip_bound:!1,root:t.target||f.$$.root};c&&c(s.root);let l=!1;if(s.ctx=r?r(e,t.props||{},(u,y,...C)=>{let N=C.length?C[0]:y;return s.ctx&&n(s.ctx[u],s.ctx[u]=N)&&(!s.skip_bound&&s.bound[u]&&s.bound[u](N),l&&Gt(e,u)),y}):[],s.update(),l=!0,_(s.before_update),s.fragment=o?o(s.ctx):!1,t.target){if(t.hydrate){et();let u=it(t.target);s.fragment&&s.fragment.l(u),u.forEach(d)}else s.fragment&&s.fragment.c();t.intro&&B(e.$$.fragment),qt(e,t.target,t.anchor),nt(),I()}h(f)}var Ut;typeof HTMLElement=="function"&&(Ut=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(e,t,r){super(),this.$$ctor=e,this.$$s=t,r&&this.attachShadow({mode:"open"})}addEventListener(e,t,r){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){let o=this.$$c.$on(e,t);this.$$l_u.set(t,o)}super.addEventListener(e,t,r)}removeEventListener(e,t,r){if(super.removeEventListener(e,t,r),this.$$c){let o=this.$$l_u.get(t);o&&(o(),this.$$l_u.delete(t))}if(this.$$l[e]){let o=this.$$l[e].indexOf(t);o>=0&&this.$$l[e].splice(o,1)}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(n){return()=>{let i;return{c:function(){i=x("slot"),n!=="default"&&F(i,"name",n)},m:function(f,s){m(f,i,s)},d:function(f){f&&d(i)}}}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;let t={},r=ct(this);for(let n of this.$$s)n in r&&(t[n]=[e(n)]);for(let n of this.attributes){let i=this.$$g_p(n.name);i in this.$$d||(this.$$d[i]=J(i,n.value,this.$$p_d,"toProp"))}for(let n in this.$$p_d)!(n in this.$$d)&&this[n]!==void 0&&(this.$$d[n]=this[n],delete this[n]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:t,$$scope:{ctx:[]}}});let o=()=>{this.$$r=!0;for(let n in this.$$p_d)if(this.$$d[n]=this.$$c.$$.ctx[this.$$c.$$.props[n]],this.$$p_d[n].reflect){let i=J(n,this.$$d[n],this.$$p_d,"toAttribute");i==null?this.removeAttribute(this.$$p_d[n].attribute||n):this.setAttribute(this.$$p_d[n].attribute||n,i)}this.$$r=!1};this.$$c.$$.after_update.push(o),o();for(let n in this.$$l)for(let i of this.$$l[n]){let c=this.$$c.$on(n,i);this.$$l_u.set(i,c)}this.$$l={}}}attributeChangedCallback(e,t,r){this.$$r||(e=this.$$g_p(e),this.$$d[e]=J(e,r,this.$$p_d,"toProp"),this.$$c?.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(e){return Object.keys(this.$$p_d).find(t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e)||e}});function J(e,t,r,o){let n=r[e]?.type;if(t=n==="Boolean"&&typeof t!="boolean"?t!=null:t,!o||!r[e])return t;if(o==="toAttribute")switch(n){case"Object":case"Array":return t==null?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return t??null;default:return t}else switch(n){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":return t;case"Number":return t!=null?+t:t;default:return t}}var D=class{$$=void 0;$$set=void 0;$destroy(){zt(this,1),this.$destroy=p}$on(t,r){if(!P(r))return p;let o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(r),()=>{let n=o.indexOf(r);n!==-1&&o.splice(n,1)}}$set(t){this.$$set&&!Z(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};var _t="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(_t);function te(e){rt(e,"svelte-1nnzhsr",".markdown-processor.svelte-1nnzhsr{padding:1rem}.error.svelte-1nnzhsr{color:red}")}function ee(e){let t;return{c(){t=x("p"),t.textContent="Markdown processed successfully!"},m(r,o){m(r,t,o)},p,d(r){r&&d(t)}}}function ne(e){let t,r,o;return{c(){t=x("p"),r=W("Error: "),o=W(e[2]),F(t,"class","error svelte-1nnzhsr")},m(n,i){m(n,t,i),M(t,r),M(t,o)},p(n,i){i&4&&st(o,n[2])},d(n){n&&d(t)}}}function re(e){let t;return{c(){t=x("p"),t.textContent="Processing markdown..."},m(r,o){m(r,t,o)},p,d(r){r&&d(t)}}}function oe(e){let t;function r(i,c){if(i[1])return re;if(i[2])return ne;if(i[0])return ee}let o=r(e,-1),n=o&&o(e);return{c(){t=x("div"),n&&n.c(),F(t,"class","markdown-processor svelte-1nnzhsr")},m(i,c){m(i,t,c),n&&n.m(t,null)},p(i,[c]){o===(o=r(i,c))&&n?n.p(i,c):(n&&n.d(1),n=o&&o(i),n&&(n.c(),n.m(t,null)))},i:p,o:p,d(i){i&&d(t),n&&n.d()}}}function ie(e,t){let r=e.split(`
`),o=new RegExp(`^#+\\s*${t}$`),n=!1,i=[],c=0;for(let a of r){let f=a.match(/^(#+)\s*(.*)$/);if(f){let s=f[1].length;o.test(a)?(n=!0,c=s,i.push(a)):n&&s<=c&&(n=!1)}n&&i.push(a)}return i.join(`
`)}function se(e,t){let r=e.split(`
`),o=new RegExp(`\\s\\^${t}$`);for(let n=0;n<r.length;n++)if(o.test(r[n]))return r[n].replace(o,"").trim();return""}function ce(e,t,r){let{app:o}=t,{activeFile:n}=t,i="",c=!1,a=null;async function f(l){let u=new Set;async function y(C){let N=/!\[\[([^\]#|^]+)(?:(#)([^\]|]+))?(?:(\^)([^\]|]+))?(?:\|([^\]]+))?\]\]/g,g=C,b;for(;(b=N.exec(C))!==null;){let T=b[0],w=b[1].trim(),mt=b[2],K=b[3],xt=b[4],Y=b[5];if(u.has(w)){console.warn(`Circular reference detected, skipping: ${w}`);continue}u.add(w);try{let j=o.metadataCache.getFirstLinkpathDest(w,"");if(j instanceof TFile){let O=await o.vault.read(j);mt&&K?O=ie(O,K):xt&&Y&&(O=se(O,Y));let $t=await y(O);g=g.replace(T,$t)}else g=g.replace(T,`<!-- Linked file not found: ${w} -->`)}catch(j){console.error(`Error processing link ${T}:`,j),g=g.replace(T,`<!-- Error: Could not process ${w} -->`)}finally{u.delete(w)}}return g}return await y(l)}async function s(){if(n){r(1,c=!0),r(2,a=null);try{let l=await o.vault.read(n);r(0,i=await f(l));let u=`${n.basename}-combined.md`,y=n.parent?`${n.parent.path}/${u}`:u;await o.vault.create(y,i)}catch(l){r(2,a=l instanceof Error?l.message:"Une erreur est survenue"),console.error("Error combining markdown:",l)}finally{r(1,c=!1)}}}return e.$$set=l=>{"app"in l&&r(3,o=l.app),"activeFile"in l&&r(4,n=l.activeFile)},[i,c,a,o,n]}var X=class extends D{constructor(t){super(),dt(this,t,ce,oe,Q,{app:3,activeFile:4},te)}},ht=X;var q=class extends $.Plugin{async onload(){this.addCommand({id:"combine-markdown-files",name:"Combine Markdown Files with Embeds",callback:async()=>{let t=this.app.workspace.getActiveFile();if(!t||!(t instanceof $.TFile)){new $.Notice("No active Markdown file to combine.");return}if(t.extension!=="md"){new $.Notice("Active file is not a Markdown file.");return}new $.Notice(`Combining ${t.name}...`),new ht({target:document.body,props:{app:this.app,activeFile:t}})}})}onunload(){}};
